steps:
  # In:
  #  user.id (str) - id of current user passed in from page
  # Out:
  #  flow.order_id (str) - id of selected order
  - type: component.order.list
    user_id: (@ user.id )
  - say: Here are the orders I found...
    # TODO: move to bot settings
    composer:
      visibility: hide
  - delay: 1
  - type: component.order.display
    orders: (@ flow.result )
  - type: component.order.get
    order_id: (@ flow.result )
  - case:
      processing:
        jump: processing
      shipped:
        jump: shipped
    default:
      jump: cant_help
    value: (@ flow.result.status )

  - (processing)
  - say: |
      Your order is still processing and could take up to 5 days to ship.
      We'll notify you when tracking is available.
    composer:
      visibility: hide
  - say: Is there something you need help with on this order?
    quick_replies:
      - text: Change my item
        action:
          jump: cant_help
      - text: Update shipping address
        action:
          jump: cant_help
      - text: Cancel my item
        action:
          flow: flow.order.cancel
          transfer: true
      - text: Nevermind
        action:
          flow: flow.start
          transfer: true
    # TODO: move to bot settings
    composer:
      visibility: hide

  - (shipped)
  - say: Your order is expected to arrive in (@ flow.result.eta ) days.
    quick_replies:
      - text: Start over
        action:
          flow: flow.start
          transfer: true

  - (cant_help)
  - say: Sorry, I can't help you with this yet, but I'm learning.
    quick_replies:
      - text: Start over
        action:
          flow: flow.start
          transfer: true
